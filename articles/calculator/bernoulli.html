<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Calculate Bernoulli Number v3</title>
  </head>
  <body>
    <h1>Calculate Bernoulli Number</h1>
    <label for="n">Enter the index of Bernoulli number:</label>
    <input type="number" id="n">
    <button onclick="calculate()">Calculate</button>
    <p id="result"></p>
    <script>
      function calculate() {
        let n = parseInt(document.getElementById("n").value);
        let result = document.getElementById("result");
        if (n < 0 || n % 1 !== 0) {
          result.innerText = "Please enter a non-negative integer";
          return;
        }
        if (n === 0) {
          result.innerText = "1";
          return;
        }
        let numerator = bernoulli(n);
        let denominator = factorial(n);
        result.innerText = numerator + "/" + denominator;
      }

      function bernoulli(n) {
        let b = [1];
        for (let m = 1; m <= n; m++) {
          b[m] = 0;
          for (let k = 0; k < m; k++) {
            b[m] -= binomial(m + 1, k) * bernoulli(k) / (m - k + 1);
          }
        }
        return b[n];
      }

      function factorial(n) {
        let result = 1;
        for (let i = 2; i <= n; i++) {
          result *= i;
        }
        return result;
      }

      function binomial(n, k) {
        if (k < 0 || k > n) {
          return 0;
        }
        let result = 1;
        for (let i = 1; i <= k; i++) {
          result *= n - i + 1;
          result /= i;
        }
        return result;
      }
    </script>
  </body>
</html>
