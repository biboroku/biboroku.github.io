<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>第1種完全楕円積分の計算</title>
  </head>
  <body>
    <h1>第1種完全楕円積分の計算</h1>
    <p>楕円の軸の長さ a, b と楕円積分のパラメーター m を入力してください。</p>
    <form>
      a: <input type="number" id="a"><br>
      b: <input type="number" id="b"><br>
      m: <input type="number" id="m"><br>
      <br>
      <input type="button" value="計算" onclick="calculate()">
    </form>
    <br>
    <p>結果: <span id="result"></span></p>
    
    <script>
      function calculate() {
        // 入力値を取得
        const a = document.getElementById("a").value;
        const b = document.getElementById("b").value;
        const m = document.getElementById("m").value;
        
        // 第1種完全楕円積分の計算
        const K = ellipK(m);
        
        // 結果を表示
        const result = document.getElementById("result");
        result.innerHTML = `K(m) = ${K.toFixed(5)}`;
      }
      
      // 第1種完全楕円積分の計算
      function ellipK(m) {
        const eps = 1e-10;
        let k = Math.sqrt(1 - m);
        let K = Math.PI / 2;
        let prevK = 0;
        let n = 1;
        
        while (Math.abs(K - prevK) > eps) {
          prevK = K;
          const sinK = Math.sin(K);
          const cosK = Math.cos(K);
          const e2 = k * k;
          const e4 = e2 * e2;
          const e6 = e2 * e4;
          const e8 = e4 * e4;
          const term = (1 / (n * n)) * (e2 + (2 * e4 * sinK * sinK) + (e6 * sinK * sinK * sinK * sinK) + (2 * e8 * sinK * sinK * sinK * sinK * cosK * cosK));
          K = K + term;
          n = n + 1;
        }
        
        return K;
      }
    </script>
  </body>
</html>
