<!DOCTYPE html>
<html>
<head>
	<title>数列の総乗を計算する</title>
</head>
<body>
	<h1>数列の総乗を計算するv3</h1>
	<p>数列の式, 初項, 末項を入力してください。</p>
	<form>
		<label for="formula">数列の式:</label>
		<input type="text" id="formula"><br>

		<label for="first-term">初項:</label>
		<input type="number" id="first-term"><br>

		<label for="last-term">末項:</label>
		<input type="number" id="last-term"><br>

		<input type="button" value="計算" onclick="calculateProduct()">
	</form>

	<p id="result"></p>

	<script>
		// べき乗関数を定義する
		function power(base, exponent) {
			return Math.pow(base, exponent);
		}

		function calculateProduct() {
			// 入力値を取得
			const formula = document.getElementById("formula").value;
			const firstTerm = parseInt(document.getElementById("first-term").value);
			const lastTerm = parseInt(document.getElementById("last-term").value);

			// 数列の式を評価する関数を作成
			const evaluateFormula = new Function("n", "return " + formula.replace(/([a-zA-Z]+)\^(\d+)/g, "power($1, $2)"));

			// 総乗を計算する
			let product = 1;
			for (let n = firstTerm; n <= lastTerm; n++) {
				product *= evaluateFormula(n);
			}

			// 結果を表示
			document.getElementById("result").innerHTML = "総乗は " + product + " です。";
		}
	</script>
</body>
</html>
